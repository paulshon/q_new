import streamlit as st
import pandas as pd
import os
import smtplib
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
from email.mime.base import MIMEBase
from email import encoders

st.title('Send Streamlit SMTP Email with Attachment ğŸ’Œ ğŸš€')

st.markdown("""
**Enter your email, subject, and email body then hit send to receive an email with an attachment!**
""")

# Taking inputs
email_sender = st.text_input('From', 'your_email@gmail.com')
email_receiver = st.text_input('To', 'sarangred@paran.com')
subject = st.text_input('Subject')
body = st.text_area('Body')

# Hide the password input
password = st.text_input('Password', type="password")

# File upload
uploaded_file = st.file_uploader("Upload Excel file", type=['xls', 'xlsx'])

# ì„¤ë¬¸ì¡°ì‚¬ ì…ë ¥ ë¶€ë¶„ ì¶”ê°€
st.write("""
# ìƒì„±í˜• AIì™€ ì¸ê°„ì˜ ì°½ì‘ì— ê´€í•œ ì„¤ë¬¸ì¡°ì‚¬
ì•„ë˜ì˜ í‘œëŠ” Që°©ë²•ë¡ (ì£¼ê´€ì„±ì—°êµ¬)ì˜ Q í‘œë³¸ ë¶„ë¥˜í‘œì…ë‹ˆë‹¤. ì•„ë˜ì˜ í‘œë¥¼ ë³´ì‹œë©´ -4ëŠ” "ê°•í•œ ë¹„ë™ì˜"ë¥¼ ë‚˜íƒ€ë‚´ê³ , 4ëŠ” "ê°•í•œ ë™ì˜"ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤. ê° ìˆ«ìì— í•´ë‹¹í•˜ëŠ” ì˜ê²¬ì„ ì„ íƒí•˜ì—¬ ì„¤ë¬¸ì— ì°¸ì—¬í•´ì£¼ì„¸ìš”. ì˜ˆë¥¼ ë“¤ì–´, -4ë¥¼ ì„ íƒí•˜ë©´ "ê°•í•œ ë¶ˆë™ì˜", 0ì„ ì„ íƒí•˜ë©´ "ì¤‘ë¦½"ì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ë°©ì‹ìœ¼ë¡œ ë‹¹ì‹ ì˜ ì˜ê²¬ì„ ì„ íƒí•´ì£¼ì„¸ìš”.
ë‹¨, ì—¬ê¸°ì—ì„œ ì¤‘ìš”í•œ ê²ƒì€ ì•„ë˜ì˜ ì¹¸ì²˜ëŸ¼

-4ëŠ” 2ë²ˆ
-3ì€ 3ë²ˆ
-2ëŠ” 4ë²ˆ
-1ì€ 4ë²ˆ
0 ì€ 5ë²ˆ
+1ì€ 4ë²ˆ
+2ëŠ” 4ë²ˆ
+3ì€ 3ë²ˆ
+4ëŠ” 2ë²ˆ

ìœ¼ë¡œ -4ì˜ ê°•í•œ ë¹„ë™ì˜ì™€ +4ì˜ ê°•í•œ ë™ì˜ ì‚¬ì´ì— ì„ íƒì˜ ì œí•œì´ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ë©´ -4ë¥¼ 2ë²ˆì´ìƒ, -3ì„ 3ë²ˆ ì´ìƒ, -2ë¥¼ 4ë²ˆì´ìƒ ì„ íƒí•˜ì‹œë©´ ì•ˆë©ë‹ˆë‹¤

ì˜ˆë¥¼ ë“¤ë©´ ì•„ë˜ì˜ ì§„ìˆ ë¬¸ì—ì„œ

"AI ì˜ˆìˆ ì€ ì˜ˆìˆ ê°€ì™€ í•¨ê»˜ í˜‘ë ¥í•˜ì—¬ ì˜ˆìˆ ì˜ ë‹¤ì–‘ì„±ì„ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆë‹¤"ì—ì„œ +4ë¥¼ ì„ íƒí–ˆìœ¼ë©´

ë‹¤ìŒ ì§„ìˆ ë¬¸ì—ì„œ +4ë¥¼ ì„ íƒí•  ìˆ˜ ìˆëŠ” ê²ƒì€ 1ë²ˆ ë‚¨ì•˜ë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤

ë˜ ë‹¤ë¥¸ ì˜ˆë¥¼ ë“¤ë©´ ì•„ë˜ì˜ ì§„ìˆ ë¬¸ì—ì„œ "ìƒì„±í˜• AIë¡œ ë§Œë“  ì˜ˆìˆ  ì‘í’ˆì„ êµ¬ë§¤í•  ì˜í–¥ì´ ìˆë‹¤"ì—ì„œ 0ì¸ ì¤‘ë¦½ì„ ì„ íƒí–ˆìœ¼ë©´ ë‹¤ìŒ ì§„ìˆ ë¬¸ì—ì„œ 0ë¥¼ ì„ íƒí•  ìˆ˜ ìˆëŠ” ê²ƒì€ 4ë²ˆ ë‚¨ì•˜ë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.

ì§„ìˆ ë¬¸ì„ ì²´í¬í•˜ì‹¤ë•Œë§ˆë‹¤ ìë™ìœ¼ë¡œ ê°•ë„ì˜ ìˆ˜ê°€ ì¤„ì–´ë“¤ê²Œ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

ì•„ë˜ì—ì„œ ê° ì§„ìˆ ë¬¸ì— ëŒ€í•œ ì‘ë‹µì„ ì„ íƒí•˜ì„¸ìš”. ê° ì§„ìˆ ë¬¸ì€ ë‹¤ìŒê³¼ ê°™ì´ ê°•ë„ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì²´í¬ë°•ìŠ¤ë¡œ í‘œì‹œë©ë‹ˆë‹¤:

- (-4) ê°•í•œ ë¹„ë™ì˜
- (-3)
- (-2)
- (-1)
- (0) ì¤‘ë¦½
- (1)
- (2)
- (3)
- (4) ê°•í•œ ë™ì˜

ê° ì‘ë‹µì€ ì—‘ì…€ íŒŒì¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤. ì €ì¥ëœìœ„ì¹˜ëŠ” C:/Users/Public/Documents/ì…ë‹ˆë‹¤.ì—‘ì…€íŒŒì¼ì€ sarangred@paran.comìœ¼ë¡œ ë³´ë‚´ì‹œë©´ ë©ë‹ˆë‹¤.
""")

# ì´ë¯¸ì§€ ì¶”ê°€
image_path = "q_st.png"
st.image(image_path, caption="Q ë¶„ë¥˜í‘œ", use_column_width=True)

st.write("""
Q í‘œë³¸ ë¶„ë¥˜í‘œë¥¼ ë³´ì‹œë©´ -4ëŠ” "ê°•í•œ ë¹„ë™ì˜"ë¥¼ ë‚˜íƒ€ë‚´ê³ , 4ëŠ” "ê°•í•œ ë™ì˜"ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤. 
ê° ìˆ«ìì— í•´ë‹¹í•˜ëŠ” ì˜ê²¬ì„ ì„ íƒí•˜ì—¬ ì„¤ë¬¸ì— ì°¸ì—¬í•´ì£¼ì„¸ìš”. 
ì˜ˆë¥¼ ë“¤ì–´, -4ë¥¼ ì„ íƒí•˜ë©´ "ê°•í•œ ë¶ˆë™ì˜", 0ì„ ì„ íƒí•˜ë©´ "ì¤‘ë¦½"ì„ ì˜ë¯¸í•©ë‹ˆë‹¤. 
""")

# ì§„ìˆ ë¬¸ ë¦¬ìŠ¤íŠ¸
statements = [
    "ì˜ˆìˆ ê°€ëŠ” AIì˜ ë„ì›€ì„ ë°›ì•„ ìƒˆë¡œìš´ ì‹œê°ê³¼ ì˜ê°ì„ ì–»ì„ ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” ì°½ì˜ì„±ì„ ì´‰ì§„í•  ìˆ˜ ìˆë‹¤",
    "AIê¸°ìˆ ê³¼ ì¸ê°„ ì˜ˆìˆ ì˜ ìœµí•©ì€ ì¸ê°„ì˜ ê³ ìœ í•œ ì°½ì˜ì„±ì„ ë” ë°œì „ì‹œí‚¬ ìˆ˜ ìˆë‹¤.",
    "AI ì˜ˆìˆ ì€ ì˜ˆìˆ ê°€ì™€ í•¨ê»˜ í˜‘ë ¥í•˜ì—¬ ì˜ˆìˆ ì˜ ë‹¤ì–‘ì„±ì„ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆë‹¤",
    "ìƒì„±í˜• AIë¥¼ í†µí•´ ì˜ˆìˆ ê°€ì˜ ë…¸ë ¥ê³¼ ì°½ì˜ì„±ì„ ë°˜ì˜í•˜ë©´ì„œ ê´€ê°ë“¤ì—ê²Œ ìƒˆë¡œìš´ ì˜ˆìˆ  ê²½í—˜ì„ ì œê³µí•  ìˆ˜ ìˆë‹¤.",
    "ì˜ˆìˆ ê°€ì™€ AIì˜ í˜‘ë ¥ì€ ì˜ˆìˆ ê³¼ ê¸°ìˆ ë¶„ì•¼ í˜ì‹ ê³¼ ë°œì „ì— ê¸ì •ì ì¸ ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆë‹¤",
    "ìƒì„±í˜• AIë¥¼ í™œìš©í•˜ì—¬ í•™ìƒë“¤ì´ ì°½ì˜ì ìœ¼ë¡œ ìƒê°í•˜ê³  ì˜ˆìˆ ì ì¸ í‘œí˜„ì„ í•  ìˆ˜ ìˆëŠ” ê¸°íšŒë¥¼ ì œê³µí•  ìˆ˜ ìˆì„ ê²ƒìœ¼ë¡œ ê¸°ëŒ€ëœë‹¤",
    "ìƒì„±í˜• AIë„êµ¬ë¥¼ ì‚¬ìš©í•œì ì€ ìˆì§€ë§Œ ì§ì ‘ì ì¸ ë„ì›€ì´ ë˜ì§„ ì•Šì•˜ë‹¤",
    "AIë¥¼ í†µí•œ ì°½ì‘ë¬¼ì€ ë¹ ë¥´ê²Œ ìƒì„±ë˜ì§€ë§Œ, ê·¸ ì•ˆì—ëŠ” ì¸ê°„ì˜ ê°ì„±ê³¼ ê²½í—˜ì´ ë‹´ê²¨ ìˆì§€ ì•Šì„ ìˆ˜ ìˆë‹¤",
    "AI ì˜ˆìˆ ë³´ë‹¤ëŠ” ì¸ê°„ ì˜ˆìˆ ê°€ì˜ ê°œì„±ê³¼ ê²½í—˜ì´ ì˜ˆìˆ ì‘í’ˆì˜ ì§„ì •í•œ ê°€ì¹˜ë¥¼ ê²°ì •í•œë‹¤",
    "AI ì˜ˆìˆ ì€ ì˜ˆìˆ ê°€ì˜ ì°½ì˜ì„±ì„ ë³´ì™„í•  ë¿ë§Œ ì•„ë‹ˆë¼ ìƒˆë¡œìš´ ì˜ˆìˆ  í˜•íƒœë¥¼ ê°œì²™í•  ìˆ˜ ìˆëŠ” ê°€ëŠ¥ì„±ì„ ì œì‹œí•œë‹¤",
    "ì˜ˆìˆ ì€ ì¸ê°„ì˜ ê°ì •ê³¼ ì´ì•¼ê¸°ë¥¼ í‘œí˜„í•˜ëŠ” ê²ƒì´ë©°, AIê°€ ê·¸ê²ƒì„ ëŒ€ì²´í•  ìˆ˜ ì—†ë‹¤",
    "ìƒì„±í˜• AIê°€ ë§Œë“  ì‘í’ˆê³¼ ì¸ê°„ì˜ ì‘í’ˆì€ ì°¨ì´ëŠ” ìˆê³ , ì¸ê°„ì˜ ì°½ì‘ì„ ë›°ì–´ ë„˜ì„ ìˆ˜ ì—†ë‹¤",
    "AIë¥¼ ì‚¬ìš©í•´ ì˜ˆìˆ  ì‘í’ˆì„ ë§Œë“  ì‚¬ëŒë“¤ì„ ì˜ˆìˆ ê°€ë¡œ ë°›ì•„ë“¤ì´ëŠ” ê²ƒì€ ì•ˆëœë‹¤",
    "ìƒì„±í˜• AIì—ì„œ í”„ë¡¬í”„íŠ¸(í…ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•œ)ë¡œ ë§Œë“œëŠ” ì‘í’ˆì€ ì˜ˆìˆ ì´ ì•„ë‹ˆë‹¤",
    "ì˜ˆìˆ ê°€ì™€ AIì˜ ê³µì¡´ì€ ì—†ê³  ì˜ˆìˆ  ë¶„ì•¼ ì°½ì‘ìë“¤ì˜ ì§ì—…ì„ ìƒì„ ê²ƒì´ë‹¤.",
    "AIì— ì˜í•œ ë¹ ë¥¸ ì‘ì—…ì´ ìƒì—… ì˜ˆìˆ  ì‘í’ˆì˜ ê°€ì¹˜ ê°ì†Œë¥¼ ì¼ìœ¼í‚¬ ê²ƒì´ë‹¤",
    "ìƒì„±í˜• AIì„ í†µí•œ ê¸°ì¡´ ì˜ˆìˆ ê°€ë“¤ì˜ ê¸°ë²•ì„ ë‹µìŠµí•˜ëŠ” ê²ƒì€ ì°½ì‘ì— ëŒ€í•œ ì‹¬ê°í•œ ì¹¨í•´ì´ë‹¤",
    "ìƒì„±í˜• AIë¡œ ë§Œë“  ì˜ˆìˆ  ì‘í’ˆì„ êµ¬ë§¤í•  ì˜í–¥ì´ ìˆë‹¤",
    "AIì˜ ë°œì „ì€ ì˜ˆìˆ  ì°½ì‘ì„ ë•ëŠ” í›Œë¥­í•œ ë„êµ¬ì´ê³ , ê¸°íšŒê°€ ì£¼ì–´ì§„ë‹¤ë©´ ìƒì„±í˜• AIë„êµ¬ë¥¼ ì‘í’ˆì— ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤",
    "ìƒì„±í˜• AIë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ, ë””ìì´ë„ˆë¡œì¨ íšŒì‚¬ì—ì„œ ì‚¬ìš©í•˜ê³  ì‹¶ì§€ëŠ” ì•Šë‹¤.",
    "ìƒì„±í˜• AIë¥¼ ì‚¬ìš©ì‹œ ë°°ê²½ë””ìì¸ ê°™ì€ ë°˜ë³µì ì¸ ì‘ì—…ì— ì‚¬ìš©í•˜ëŠ”ê²ƒì€ íš¨ìœ¨ì ì´ë‹¤",
    "ìƒì„±í˜•AIì™€ ë¡œë´‡ì´ ê³µì—°í•˜ëŠ” ìŒì•…ê³µì—°ì„ ê°€ê³  ì‹¶ë‹¤",
    "ìƒì„±í˜• AIë¡œ ë§Œë“  ë¯¸ìˆ  ì „ì‹œíšŒì— ê°€ì„œ ì§ì ‘ ì‘í’ˆì„ êµ¬ë§¤í•˜ê³  ì‹¶ë‹¤",
    "ìƒì„±í˜• AIë¥¼ í™œìš©í•œ ì˜ˆìˆ  êµìœ¡ì€ í•™ìƒë“¤ì—ê²Œ ì°½ì˜ì„±ê³¼ ê¸°ìˆ ì  ì—­ëŸ‰ì„ í•¨ê»˜ ê°•í™”í•˜ëŠ” ê¸°íšŒê°€ ë  ìˆ˜ ìˆë‹¤",
    "ìƒì„±í˜• AIì„ í†µí•œ ì˜ˆìˆ  ì°½ì‘ì´ ì „í†µì ì¸ ì˜ˆìˆ ê°€ì˜ ê¸°ë²•ì„ ë‹µìŠµí•˜ëŠ”ê²ƒì€ ìƒê´€ì—†ë‹¤",
    "ìƒì„±í˜• AIë¥¼ í™œìš©í•˜ì—¬ ë‹¤ì–‘í•œ ì‹œê°ê³¼ ê²½í—˜ì„ ì œê³µí•¨ìœ¼ë¡œì¨ í•™ìƒë“¤ì˜ ì°½ì˜ì„±ì„ ì¦ì§„ì‹œí‚¬ ìˆ˜ ìˆì„ ê²ƒìœ¼ë¡œ ê¸°ëŒ€ëœë‹¤",
    "ìƒì„±í˜• AIê°€ ì˜ˆìˆ  êµìœ¡ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì€ ì‹ ì¤‘íˆ ê³ ë ¤ë˜ì–´ì•¼ í•˜ë©°, ì¸ê°„ ì˜ˆìˆ ê°€ì˜ ì—­í• ê³¼ ê°€ì¹˜ë¥¼ ì§€í‚¤ëŠ” ë° ì¤‘ì ì„ ë‘˜ í•„ìš”ê°€ ìˆë‹¤",
    "ìƒì„±í˜• AIì™€ ì¸ê°„ ì˜ˆìˆ ê°€ì˜ ì°½ì¡° ê³¼ì •ì„ ë¹„êµí•˜ê³ , ì˜ˆìˆ êµìœ¡ì´ ë‘ ê°€ì§€ ì ‘ê·¼ ë°©ì‹ì˜ ì¥ë‹¨ì ì„ ì´í•´ì‹œí‚¤ëŠ”ë° ìœµí•©í•˜ëŠ”ë° ì¤‘ì ì„ ë‘˜ í•„ìš”ê°€ ìˆë‹¤",
    "AIëŠ” ì˜ˆìˆ ê°€ì˜ ì°½ì˜ì„±ì„ ë³´ì™„í•˜ê³  ìƒˆë¡œìš´ ì˜ˆìˆ  ë¶„ì•¼ì˜ ì§ì—…ì„ ì°½ì¶œí•˜ëŠ” ë° ê¸°ì—¬í•  ê²ƒì´ë‹¤.",
    "ìƒì„±í˜• AIëŠ” ì•„ì§ ì´ˆê¸° ë‹¨ê³„ì´ë¯€ë¡œ ì¸ê°„ì˜ ì˜ˆìˆ ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì€ ë¯¸ë¯¸í•˜ë‹¤",
    "AIê°€ ìƒì„±í•œ ì´ë¯¸ì§€ì— ëŒ€í•œ ì†Œìœ ê¶Œì— ëŒ€í•œ ì‹œë¹„ëŠ” ì‘í’ˆ ì‹œì¥ì˜ ë¯¸ë˜ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆëŠ” ì¤‘ìš”í•œ ë¬¸ì œì´ë‹¤"
]

# ê°•ë„ ì„ íƒ ì œí•œ
limits = {-4: 2, -3: 3, -2: 4, -1: 4, 0: 5, 1: 4, 2: 4, 3: 3, 4: 2}

# Streamlit ì•± ì‹œì‘
def main():
    st.title("ë‹¤ìŒì€ ê¸°ë³¸ ì •ë³´ ì¡°ì‚¬ì™€ ì§„ìˆ ë¬¸ì— ëŒ€í•œ ê°•ë„ ì„ íƒì…ë‹ˆë‹¤")

    # ì‚¬ìš©ì ì •ë³´ ì…ë ¥ ë°›ê¸°
    email = st.text_input("ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”:")
    age = st.text_input("ë‚˜ì´ëŒ€ë¥¼ ì…ë ¥í•˜ì„¸ìš”:")
    gender = st.radio("ì„±ë³„ì„ ì…ë ¥í•˜ì„¸ìš”:", ("ë‚¨ì„±", "ì—¬ì„±"))
    occupation = st.radio("ì°½ì‘ìì¸ê°€ìš”? í˜¹ì€ ì¼ë°˜ ì§ì—…êµ°ì¸ê°€ìš”?:", ("ì°½ì‘ì", "ì¼ë°˜ ì§ì—…êµ°"))
    occupation_specific = st.text_input("ë³¸ì¸ì˜ ì§ì—…ì€ ë¬´ì—‡ì¸ê°€ìš”?:")
    ai_usage = st.radio("ìƒì„±í˜• AIë¥¼ ì‚¬ìš©í•œ ì ì´ ìˆë‚˜ìš”?:", ("ìˆìŒ", "ì—†ìŒ"))

    # ë””ë ‰í† ë¦¬ ê²½ë¡œ
    save_directory = "C:/Users/Public/Documents/"

    responses = {}  # ì‚¬ìš©ìì˜ ì‘ë‹µì„ ì €ì¥í•  ë”•ì…”ë„ˆë¦¬

    # ê° ì§„ìˆ ë¬¸ì— ëŒ€í•œ ì²´í¬ë°•ìŠ¤ ìƒì„±
    for statement in statements:
        st.subheader(statement)
        response_selected = False
        for strength in range(-4, 5):
            if limits[strength] > 0:
                checkbox_label = f"{strength} (ê°•í•œ ë¹„ë™ì˜)" if strength == -4 else f"{strength} (ê°•í•œ ë™ì˜)" if strength == 4 else f"{strength} (ì¤‘ë¦½)" if strength == 0 else str(
                    strength)
                checkbox_key = f"{statement}_{strength}"
                checkbox_value = st.checkbox(checkbox_label, key=checkbox_key)
                if checkbox_value:
                    responses[statement] = strength
                    limits[strength] -= 1
                    response_selected = True
                    break  # í•˜ë‚˜ì˜ ê°•ë„ê°€ ì„ íƒë˜ë©´ ë°˜ë³µ ì¤‘ë‹¨
        if not response_selected:
            responses[statement] = "ì‘ë‹µ ì—†ìŒ"  # ì‘ë‹µì´ ì—†ëŠ” ê²½ìš° ì²˜ë¦¬

    if st.button("ì„¤ë¬¸ ì œì¶œ"):
        # ì„¤ë¬¸ ê²°ê³¼ë¥¼ íŒë‹¤ìŠ¤ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë³€í™˜
        df_responses = pd.DataFrame(list(responses.items()), columns=['ì§„ìˆ ë¬¸', 'ì‘ë‹µ'])
        df_responses['ì´ë©”ì¼ ì£¼ì†Œ'] = email
        df_responses['ë‚˜ì´ëŒ€'] = age
        df_responses['ì„±ë³„'] = gender
        df_responses['ì§ì—…'] = occupation
        df_responses['ì§ì—…(ì„¸ë¶€)'] = occupation_specific
        df_responses['ìƒì„±í˜• AI ì‚¬ìš© ì—¬ë¶€'] = ai_usage

        # ì—‘ì…€ íŒŒì¼ë¡œ ì €ì¥
        if not os.path.exists(save_directory):
            os.makedirs(save_directory)
        excel_file_path = os.path.join(save_directory, "ì„¤ë¬¸_ê²°ê³¼.xlsx")
        df_responses.to_excel(excel_file_path, index=False)
        st.success(f"ì„¤ë¬¸ ê²°ê³¼ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤: {excel_file_path}")

    # ì´ë©”ì¼ ë³´ë‚´ê¸°
    if st.button("Send Email"):
        try:
            # Create a multipart message and set headers
            msg = MIMEMultipart()
            msg['From'] = email_sender
            msg['To'] = email_receiver
            msg['Subject'] = subject

            # Add body to email
            msg.attach(MIMEText(body, 'plain'))

            if uploaded_file is not None:
                # Attach file
                part = MIMEBase('application', "octet-stream")
                part.set_payload(uploaded_file.getvalue())
                encoders.encode_base64(part)
                part.add_header('Content-Disposition', f"attachment; filename= {uploaded_file.name}")
                msg.attach(part)

            # Convert message to string
            text = msg.as_string()

            # Log in to server and send email
            with smtplib.SMTP('smtp.gmail.com', 587) as server:
                server.starttls()
                server.login(email_sender, password)
                server.sendmail(email_sender, email_receiver, text)

            st.success('Email sent successfully! ğŸš€')
        except Exception as e:
            st.error(f"Failed to send email: {e}")

if __name__ == "__main__":
    main()
